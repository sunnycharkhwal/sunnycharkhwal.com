{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar t = _interopRequireWildcard(require(\"@babel/types\"));\n\nvar _importBuilder = _interopRequireDefault(require(\"./import-builder\"));\n\nvar _isModule = _interopRequireDefault(require(\"./is-module\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function () {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nconst assert = require(\"assert\");\n\nclass ImportInjector {\n  constructor(path, importedSource, opts) {\n    this._defaultOpts = {\n      importedSource: null,\n      importedType: \"commonjs\",\n      importedInterop: \"babel\",\n      importingInterop: \"babel\",\n      ensureLiveReference: false,\n      ensureNoContext: false,\n      importPosition: \"before\"\n    };\n    const programPath = path.find(p => p.isProgram());\n    this._programPath = programPath;\n    this._programScope = programPath.scope;\n    this._hub = programPath.hub;\n    this._defaultOpts = this._applyDefaults(importedSource, opts, true);\n  }\n\n  addDefault(importedSourceIn, opts) {\n    return this.addNamed(\"default\", importedSourceIn, opts);\n  }\n\n  addNamed(importName, importedSourceIn, opts) {\n    assert(typeof importName === \"string\");\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), importName);\n  }\n\n  addNamespace(importedSourceIn, opts) {\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), null);\n  }\n\n  addSideEffect(importedSourceIn, opts) {\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), false);\n  }\n\n  _applyDefaults(importedSource, opts, isInit = false) {\n    const optsList = [];\n\n    if (typeof importedSource === \"string\") {\n      optsList.push({\n        importedSource\n      });\n      optsList.push(opts);\n    } else {\n      assert(!opts, \"Unexpected secondary arguments.\");\n      optsList.push(importedSource);\n    }\n\n    const newOpts = Object.assign({}, this._defaultOpts);\n\n    for (const opts of optsList) {\n      if (!opts) continue;\n      Object.keys(newOpts).forEach(key => {\n        if (opts[key] !== undefined) newOpts[key] = opts[key];\n      });\n\n      if (!isInit) {\n        if (opts.nameHint !== undefined) newOpts.nameHint = opts.nameHint;\n        if (opts.blockHoist !== undefined) newOpts.blockHoist = opts.blockHoist;\n      }\n    }\n\n    return newOpts;\n  }\n\n  _generateImport(opts, importName) {\n    const isDefault = importName === \"default\";\n    const isNamed = !!importName && !isDefault;\n    const isNamespace = importName === null;\n    const {\n      importedSource,\n      importedType,\n      importedInterop,\n      importingInterop,\n      ensureLiveReference,\n      ensureNoContext,\n      nameHint,\n      importPosition,\n      blockHoist\n    } = opts;\n    let name = nameHint || importName;\n    const isMod = (0, _isModule.default)(this._programPath);\n    const isModuleForNode = isMod && importingInterop === \"node\";\n    const isModuleForBabel = isMod && importingInterop === \"babel\";\n\n    if (importPosition === \"after\" && !isMod) {\n      throw new Error(`\"importPosition\": \"after\" is only supported in modules`);\n    }\n\n    const builder = new _importBuilder.default(importedSource, this._programScope, this._hub);\n\n    if (importedType === \"es6\") {\n      if (!isModuleForNode && !isModuleForBabel) {\n        throw new Error(\"Cannot import an ES6 module from CommonJS\");\n      }\n\n      builder.import();\n\n      if (isNamespace) {\n        builder.namespace(nameHint || importedSource);\n      } else if (isDefault || isNamed) {\n        builder.named(name, importName);\n      }\n    } else if (importedType !== \"commonjs\") {\n      throw new Error(`Unexpected interopType \"${importedType}\"`);\n    } else if (importedInterop === \"babel\") {\n      if (isModuleForNode) {\n        name = name !== \"default\" ? name : importedSource;\n        const es6Default = `${importedSource}$es6Default`;\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(es6Default).var(name || importedSource).wildcardInterop();\n        } else if (isDefault) {\n          if (ensureLiveReference) {\n            builder.default(es6Default).var(name || importedSource).defaultInterop().read(\"default\");\n          } else {\n            builder.default(es6Default).var(name).defaultInterop().prop(importName);\n          }\n        } else if (isNamed) {\n          builder.default(es6Default).read(importName);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.namespace(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource).wildcardInterop();\n        } else if ((isDefault || isNamed) && ensureLiveReference) {\n          if (isDefault) {\n            name = name !== \"default\" ? name : importedSource;\n            builder.var(name).read(importName);\n            builder.defaultInterop();\n          } else {\n            builder.var(importedSource).read(importName);\n          }\n        } else if (isDefault) {\n          builder.var(name).defaultInterop().prop(importName);\n        } else if (isNamed) {\n          builder.var(name).prop(importName);\n        }\n      }\n    } else if (importedInterop === \"compiled\") {\n      if (isModuleForNode) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.default(importedSource).read(name);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.namespace(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource);\n        } else if (isDefault || isNamed) {\n          if (ensureLiveReference) {\n            builder.var(importedSource).read(name);\n          } else {\n            builder.prop(importName).var(name);\n          }\n        }\n      }\n    } else if (importedInterop === \"uncompiled\") {\n      if (isDefault && ensureLiveReference) {\n        throw new Error(\"No live reference for commonjs default\");\n      }\n\n      if (isModuleForNode) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault) {\n          builder.default(name);\n        } else if (isNamed) {\n          builder.default(importedSource).read(name);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault) {\n          builder.default(name);\n        } else if (isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource);\n        } else if (isDefault) {\n          builder.var(name);\n        } else if (isNamed) {\n          if (ensureLiveReference) {\n            builder.var(importedSource).read(name);\n          } else {\n            builder.var(name).prop(importName);\n          }\n        }\n      }\n    } else {\n      throw new Error(`Unknown importedInterop \"${importedInterop}\".`);\n    }\n\n    const {\n      statements,\n      resultName\n    } = builder.done();\n\n    this._insertStatements(statements, importPosition, blockHoist);\n\n    if ((isDefault || isNamed) && ensureNoContext && resultName.type !== \"Identifier\") {\n      return t.sequenceExpression([t.numericLiteral(0), resultName]);\n    }\n\n    return resultName;\n  }\n\n  _insertStatements(statements, importPosition = \"before\", blockHoist = 3) {\n    const body = this._programPath.get(\"body\");\n\n    if (importPosition === \"after\") {\n      for (let i = body.length - 1; i >= 0; i--) {\n        if (body[i].isImportDeclaration()) {\n          body[i].insertAfter(statements);\n          return;\n        }\n      }\n    } else {\n      statements.forEach(node => {\n        node._blockHoist = blockHoist;\n      });\n      const targetPath = body.find(p => {\n        const val = p.node._blockHoist;\n        return Number.isFinite(val) && val < 4;\n      });\n\n      if (targetPath) {\n        targetPath.insertBefore(statements);\n        return;\n      }\n    }\n\n    this._programPath.unshiftContainer(\"body\", statements);\n  }\n\n}\n\nexports.default = ImportInjector;","map":{"version":3,"sources":["/Users/hackinghunter/Desktop/React js/my website/sunny/node_modules/@babel/helper-module-imports/lib/import-injector.js"],"names":["Object","defineProperty","exports","value","default","t","_interopRequireWildcard","require","_importBuilder","_interopRequireDefault","_isModule","obj","__esModule","_getRequireWildcardCache","WeakMap","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","assert","ImportInjector","constructor","path","importedSource","opts","_defaultOpts","importedType","importedInterop","importingInterop","ensureLiveReference","ensureNoContext","importPosition","programPath","find","p","isProgram","_programPath","_programScope","scope","_hub","hub","_applyDefaults","addDefault","importedSourceIn","addNamed","importName","_generateImport","addNamespace","addSideEffect","isInit","optsList","push","newOpts","assign","keys","forEach","undefined","nameHint","blockHoist","isDefault","isNamed","isNamespace","name","isMod","isModuleForNode","isModuleForBabel","Error","builder","import","namespace","named","es6Default","var","wildcardInterop","defaultInterop","read","prop","statements","resultName","done","_insertStatements","type","sequenceExpression","numericLiteral","body","i","length","isImportDeclaration","insertAfter","node","_blockHoist","targetPath","val","Number","isFinite","insertBefore","unshiftContainer"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar t = _interopRequireWildcard(require(\"@babel/types\"));\n\nvar _importBuilder = _interopRequireDefault(require(\"./import-builder\"));\n\nvar _isModule = _interopRequireDefault(require(\"./is-module\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst assert = require(\"assert\");\n\nclass ImportInjector {\n  constructor(path, importedSource, opts) {\n    this._defaultOpts = {\n      importedSource: null,\n      importedType: \"commonjs\",\n      importedInterop: \"babel\",\n      importingInterop: \"babel\",\n      ensureLiveReference: false,\n      ensureNoContext: false,\n      importPosition: \"before\"\n    };\n    const programPath = path.find(p => p.isProgram());\n    this._programPath = programPath;\n    this._programScope = programPath.scope;\n    this._hub = programPath.hub;\n    this._defaultOpts = this._applyDefaults(importedSource, opts, true);\n  }\n\n  addDefault(importedSourceIn, opts) {\n    return this.addNamed(\"default\", importedSourceIn, opts);\n  }\n\n  addNamed(importName, importedSourceIn, opts) {\n    assert(typeof importName === \"string\");\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), importName);\n  }\n\n  addNamespace(importedSourceIn, opts) {\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), null);\n  }\n\n  addSideEffect(importedSourceIn, opts) {\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), false);\n  }\n\n  _applyDefaults(importedSource, opts, isInit = false) {\n    const optsList = [];\n\n    if (typeof importedSource === \"string\") {\n      optsList.push({\n        importedSource\n      });\n      optsList.push(opts);\n    } else {\n      assert(!opts, \"Unexpected secondary arguments.\");\n      optsList.push(importedSource);\n    }\n\n    const newOpts = Object.assign({}, this._defaultOpts);\n\n    for (const opts of optsList) {\n      if (!opts) continue;\n      Object.keys(newOpts).forEach(key => {\n        if (opts[key] !== undefined) newOpts[key] = opts[key];\n      });\n\n      if (!isInit) {\n        if (opts.nameHint !== undefined) newOpts.nameHint = opts.nameHint;\n        if (opts.blockHoist !== undefined) newOpts.blockHoist = opts.blockHoist;\n      }\n    }\n\n    return newOpts;\n  }\n\n  _generateImport(opts, importName) {\n    const isDefault = importName === \"default\";\n    const isNamed = !!importName && !isDefault;\n    const isNamespace = importName === null;\n    const {\n      importedSource,\n      importedType,\n      importedInterop,\n      importingInterop,\n      ensureLiveReference,\n      ensureNoContext,\n      nameHint,\n      importPosition,\n      blockHoist\n    } = opts;\n    let name = nameHint || importName;\n    const isMod = (0, _isModule.default)(this._programPath);\n    const isModuleForNode = isMod && importingInterop === \"node\";\n    const isModuleForBabel = isMod && importingInterop === \"babel\";\n\n    if (importPosition === \"after\" && !isMod) {\n      throw new Error(`\"importPosition\": \"after\" is only supported in modules`);\n    }\n\n    const builder = new _importBuilder.default(importedSource, this._programScope, this._hub);\n\n    if (importedType === \"es6\") {\n      if (!isModuleForNode && !isModuleForBabel) {\n        throw new Error(\"Cannot import an ES6 module from CommonJS\");\n      }\n\n      builder.import();\n\n      if (isNamespace) {\n        builder.namespace(nameHint || importedSource);\n      } else if (isDefault || isNamed) {\n        builder.named(name, importName);\n      }\n    } else if (importedType !== \"commonjs\") {\n      throw new Error(`Unexpected interopType \"${importedType}\"`);\n    } else if (importedInterop === \"babel\") {\n      if (isModuleForNode) {\n        name = name !== \"default\" ? name : importedSource;\n        const es6Default = `${importedSource}$es6Default`;\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(es6Default).var(name || importedSource).wildcardInterop();\n        } else if (isDefault) {\n          if (ensureLiveReference) {\n            builder.default(es6Default).var(name || importedSource).defaultInterop().read(\"default\");\n          } else {\n            builder.default(es6Default).var(name).defaultInterop().prop(importName);\n          }\n        } else if (isNamed) {\n          builder.default(es6Default).read(importName);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.namespace(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource).wildcardInterop();\n        } else if ((isDefault || isNamed) && ensureLiveReference) {\n          if (isDefault) {\n            name = name !== \"default\" ? name : importedSource;\n            builder.var(name).read(importName);\n            builder.defaultInterop();\n          } else {\n            builder.var(importedSource).read(importName);\n          }\n        } else if (isDefault) {\n          builder.var(name).defaultInterop().prop(importName);\n        } else if (isNamed) {\n          builder.var(name).prop(importName);\n        }\n      }\n    } else if (importedInterop === \"compiled\") {\n      if (isModuleForNode) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.default(importedSource).read(name);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.namespace(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource);\n        } else if (isDefault || isNamed) {\n          if (ensureLiveReference) {\n            builder.var(importedSource).read(name);\n          } else {\n            builder.prop(importName).var(name);\n          }\n        }\n      }\n    } else if (importedInterop === \"uncompiled\") {\n      if (isDefault && ensureLiveReference) {\n        throw new Error(\"No live reference for commonjs default\");\n      }\n\n      if (isModuleForNode) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault) {\n          builder.default(name);\n        } else if (isNamed) {\n          builder.default(importedSource).read(name);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault) {\n          builder.default(name);\n        } else if (isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource);\n        } else if (isDefault) {\n          builder.var(name);\n        } else if (isNamed) {\n          if (ensureLiveReference) {\n            builder.var(importedSource).read(name);\n          } else {\n            builder.var(name).prop(importName);\n          }\n        }\n      }\n    } else {\n      throw new Error(`Unknown importedInterop \"${importedInterop}\".`);\n    }\n\n    const {\n      statements,\n      resultName\n    } = builder.done();\n\n    this._insertStatements(statements, importPosition, blockHoist);\n\n    if ((isDefault || isNamed) && ensureNoContext && resultName.type !== \"Identifier\") {\n      return t.sequenceExpression([t.numericLiteral(0), resultName]);\n    }\n\n    return resultName;\n  }\n\n  _insertStatements(statements, importPosition = \"before\", blockHoist = 3) {\n    const body = this._programPath.get(\"body\");\n\n    if (importPosition === \"after\") {\n      for (let i = body.length - 1; i >= 0; i--) {\n        if (body[i].isImportDeclaration()) {\n          body[i].insertAfter(statements);\n          return;\n        }\n      }\n    } else {\n      statements.forEach(node => {\n        node._blockHoist = blockHoist;\n      });\n      const targetPath = body.find(p => {\n        const val = p.node._blockHoist;\n        return Number.isFinite(val) && val < 4;\n      });\n\n      if (targetPath) {\n        targetPath.insertBefore(statements);\n        return;\n      }\n    }\n\n    this._programPath.unshiftContainer(\"body\", statements);\n  }\n\n}\n\nexports.default = ImportInjector;"]},"metadata":{},"sourceType":"script"}